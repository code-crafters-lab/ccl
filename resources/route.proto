edition = "2023";

option go_package = "github.com/code-crafters-lab/idl/resources";
option java_package = "org.ccl.resources";
option java_outer_classname = "RouteProto";
option java_multiple_files = true;

package resources;

/**
 * 资源类型
 */
enum ResourceType {
    // 系统（应用）资源
    RESOURCE_TYPE_APP = 0;
    // 菜单资源
    RESOURCE_TYPE_MENU = 1;
    // 操作资源
    RESOURCE_TYPE_OPERATION = 2;
    // 数据资源
    RESOURCE_TYPE_DATA_LIMIT = 3;
    // 接口资源
    RESOURCE_TYPE_API = 4;
    // 外链资源
    RESOURCE_TYPE_EXTERNAL_LINK = 5;
}

/**
 * 应用资源
 */
message App {
    // 应用 ID
    string id = 1;
    // 应用名称
    string name = 2;
    // 应用描述
    string description = 3;
    // 菜单列表
    repeated Menu menus = 4;
    // 路由列表
    repeated Route routes = 5;

    reserved 6 to 10;
}

/**
 * 菜单资源
 */
message Menu {
    // 菜单 ID
    string id = 1;
    // 菜单名称
    string name = 2;
    // 菜单唯一性编码（二进制字符转十进制字符串）
    string code = 3;
    // 菜单图标
    string icon = 4;
    // 菜单排序
    int32 sort = 5;
    // 页面路由或外链路由
    Route route = 6;

    reserved 7 to 10;
}

message Authority {
    // 命名空间
    string namespace = 1;
    // 资源一性编码（二进制权限位 => 十进制表示）
    string code = 2;
}

message Resource {
    // 资源 ID
    string id = 1;
    // 父资源 ID
    string pid = 2;
    // 资源名称
    string name = 3;
    // 资源类型
    ResourceType type = 4;
    // 资源排序
    int32 sort = 5;

    // 资源数据
    oneof data {
        // 应用资源
        App app = 11;
        // 菜单资源
        Menu menu = 12;
        // 操作资源
        Operation operation = 13;
        // 数据资源
        DataLimit data_limit = 14;
        // 接口资源
        RestApi api = 15;
        // 外链资源
        ExternalLink external_link = 16;
    }

    reserved 6 to 10, 17 to 20;

    repeated Resource children = 21; // 子资源集合
}

/**
 * 页面操作
 */
message Operation {
    string id = 1; // 操作 ID
    string name = 2; // 操作名称
    Location location = 3; // 操作位置
    Route route = 4; // 操作关联的路由资源
    int32 sort = 5;  // 操作排序

    enum Location {
        UNKNOWN = 0; // 未知位置
        TOOL_BAR = 1; // 工具栏
        ACTION_COLUMN = 2; // 操作栏
    }
}

enum RouteType {
    ROUTE_TYPE_UNKNOWN = 0; // 未知类型
    ROUTE_TYPE_PAGE = 1; // HTML 页面
    ROUTE_TYPE_API = 2; // REST API
    ROUTE_TYPE_EXTERNAL_LINK = 3; // 外链资源
}

message RestApi {
    string id = 1; // 接口 ID
    string code = 2; // 编码
    string name = 3; // 名称
    string method = 5; // 请求方法
    string path = 6; // 接口地址
    string classify = 4; // 分类
    string color = 7; // 颜色
}

message DataLimit {
    string id = 1; // 数据 ID
    string code = 2; // 编码
    string name = 3; // 名称
    string description = 4; // 描述
}

message Page {
    string id = 1; // 路由 ID
    string path = 2; // 路由路径
    string template = 3; // HTML 模板文件路径
    string code = 4; // 路由唯一性编码（二进制字符转十进制字符串）
    repeated Operation operations = 5; // 页面操作
}

message ExternalLink {
    string id = 1; // 外链 ID
    string name = 2; // 名称
    string url = 3; // url 地址
    optional string description = 4; // 外链描述
}

/**
 * 路由
 */
message Route {
    string id = 1; // 路由 ID
    string code = 2; // 路由唯一性编码（二进制字符转十进制字符串）
    RouteType type = 3; // 路由类型

    oneof data {
        Page page = 4; // HTML 页面路由
        RestApi api = 5; // 接口资源
        ExternalLink external_link = 6; // 外链资源
    }
}








